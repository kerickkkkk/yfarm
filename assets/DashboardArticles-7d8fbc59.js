import{P as O}from"./PaginationComponent-930fbe8c.js";import{s as V}from"./service-76d60509.js";import{g as z}from"./filters-87564b85.js";import{i as H,r as f,h as I,a as F,o as c,c as r,b as e,d as v,w as J,t as g,n as E,E as P,M as N,F as T,v as B,H as G,O as K,k as L,j as Q,u as R}from"./index-5356cf8e.js";import{M as W}from"./modal-57346e3c.js";import{_ as X}from"./DeleteItemModal-42cbcbe9.js";import"./plugin-vueexport-helper-c27b6911.js";import"./component-functions-4ab743b4.js";function Y(d=1){return V({method:"GET",url:`/admin/articles?page=${d}`})}function Z(d){return V({method:"GET",url:`/admin/article/${d}`})}function ee(d){return V({method:"PUT",url:`/admin/article/${d.id}`,data:{data:d}})}function te(d){return V({method:"DELETE",url:`/admin/article/${d}`})}function le(d){return V({method:"POST",url:"/admin/article",data:{data:d}})}const se="/yfarm/assets/noImage-f4958a46.png",ae={id:"modal",class:"modal fade modal-xl",tabindex:"-1","aria-hidden":"true"},oe={class:"modal-dialog"},ne={class:"modal-content border-0"},ie={class:"modal-header"},de={id:"modalLabel",class:"modal-title"},ce=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ue={class:"modal-body"},re={class:"row"},me={class:"col-md-6"},_e={class:"mb-3"},he=e("label",{for:"title",class:"form-label"},[e("span",{class:"text-danger"},"*"),L(" 標題")],-1),pe={class:"mb-3"},ve=e("label",{for:"author",class:"form-label"},[e("span",{class:"text-danger"},"*"),L(" 作者")],-1),be={class:"mb-3"},ge=e("label",{for:"description",class:"form-label"},"描述",-1),fe={class:"mb-3"},ye=e("label",{for:"tempTag",class:"form-label"},"標籤",-1),ke={class:"input-group mb-3"},xe=["disabled"],we={key:0,class:"d-flex flex-wrap"},Ae=["onClick"],$e=e("div",{class:"text-warning"},[e("span",null,"再點一次，就取消。")],-1),Ve={class:"mb-3"},Me={class:"form-check"},Ce=e("label",{class:"form-check-label",for:"isPublic"},"是否發布",-1),Pe={class:"col-md-6"},Ee={class:"mb-2"},Te={class:"mb-3"},Ue=e("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),De=["src"],Fe={class:"mb-3"},Ne=e("label",{for:"content",class:"form-label"},[e("span",{class:"text-danger"},"*"),L(" 內容")],-1),Be=e("button",{type:"submit",class:"btn btn-secondary"}," 確認 ",-1),Ge={__name:"ModifyArticlesModal",emits:["getArticles"],setup(d,{expose:x,emit:w}){const b=H("$swal"),t=f({title:"",author:""}),u=f(null),h=f(!1),U=(a,s)=>{h.value=a,h.value?(t.value={title:"",author:""},u.value.show()):Z(s.id).then(({data:_})=>{t.value=_.article,u.value.show()})},p=f(""),M=()=>{t.value={},p.value=""},i=()=>{u.value.hide(),M()},o=()=>{ee(t.value).then(({data:a})=>{b(a.message),w("getArticles"),i()}).catch(a=>{var s,_;b("",((_=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:_.message)||"有錯誤","error")})},l=()=>{t.value.isPublic===void 0&&(t.value.isPublic=!1),t.value={...t.value,create_at:new Date().getTime()},le(t.value).then(({data:a})=>{b(a.message),w("getArticles"),i()}).catch(a=>{var y,C,k,$;const s=(C=(y=a==null?void 0:a.response)==null?void 0:y.data)==null?void 0:C.message,_=Array.isArray(s)?s.join(","):s;console.log(($=(k=a==null?void 0:a.response)==null?void 0:k.data)==null?void 0:$.message),b("",_||"有錯誤","error")})},m=()=>{h.value?l():o()},A=()=>{if(p.value==="")return!1;t.value.tag===void 0&&(t.value.tag=[]),t.value.tag.push(p.value),p.value=""},D=a=>{t.value.tag.splice(a,1)},S=a=>{a.target.src=se};return I(()=>{u.value=new W("#modal",{focus:!1})}),x({show:U}),(a,s)=>{const _=F("VField"),y=F("ErrorMessage"),C=F("VForm");return c(),r("div",ae,[e("div",oe,[e("div",ne,[v(C,{onSubmit:m},{default:J(({errors:k})=>{var $,j;return[e("div",ie,[e("h5",de,g(h.value?"新增":"修改")+"文章 ",1),ce]),e("div",ue,[e("div",re,[e("div",me,[e("div",_e,[he,v(_,{id:"title",modelValue:t.value.title,"onUpdate:modelValue":s[0]||(s[0]=n=>t.value.title=n),modelModifiers:{trim:!0},name:"標題",type:"text",class:E(["form-control",{"is-invalid":k.標題}]),placeholder:"請輸入標題",rules:"required"},null,8,["modelValue","class"]),v(y,{name:"標題",class:"invalid-feedback"})]),e("div",pe,[ve,v(_,{id:"author",modelValue:t.value.author,"onUpdate:modelValue":s[1]||(s[1]=n=>t.value.author=n),modelModifiers:{trim:!0},name:"作者",type:"text",class:E(["form-control",{"is-invalid":k.作者}]),placeholder:"請輸入作者",rules:"required"},null,8,["modelValue","class"]),v(y,{name:"作者",class:"invalid-feedback"})]),e("div",be,[ge,P(e("input",{id:"description","onUpdate:modelValue":s[2]||(s[2]=n=>t.value.description=n),type:"text",class:"form-control",placeholder:"請輸入描述"},null,512),[[N,t.value.description]])]),e("div",fe,[ye,e("div",ke,[P(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>p.value=n),type:"text",class:"form-control",placeholder:"輸入標籤"},null,512),[[N,p.value]]),e("button",{disabled:p.value==="",class:"btn btn-outline-secondary",type:"button",onClick:A}," 輸入 ",8,xe)]),((j=($=t.value)==null?void 0:$.tag)==null?void 0:j.length)>0?(c(),r("div",we,[(c(!0),r(T,null,B(t.value.tag,(n,q)=>(c(),r("button",{key:q,class:"btn btn-sm btn-outline-info mb-2 me-2",onClick:We=>D(q)},g(n),9,Ae))),128)),$e])):G("",!0)]),e("div",Ve,[e("div",Me,[P(e("input",{id:"isPublic","onUpdate:modelValue":s[4]||(s[4]=n=>t.value.isPublic=n),class:"form-check-input",type:"checkbox"},null,512),[[K,t.value.isPublic]]),Ce])])]),e("div",Pe,[e("div",Ee,[e("div",Te,[Ue,P(e("input",{id:"imageUrl","onUpdate:modelValue":s[5]||(s[5]=n=>t.value.image=n),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[N,t.value.image]])]),e("img",{class:"img-fluid",src:t.value.image,alt:"image",onError:S},null,40,De)])])]),e("div",null,[e("div",Fe,[Ne,v(_,{id:"content",modelValue:t.value.content,"onUpdate:modelValue":s[6]||(s[6]=n=>t.value.content=n),as:"textarea",cols:"30",rows:"10",name:"內容",type:"text",class:E(["form-control",{"is-invalid":k.內容}]),placeholder:"請輸入內容",rules:"required"},null,8,["modelValue","class"]),v(y,{name:"內容",class:"invalid-feedback"})])])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:i}," 取消 "),Be])]}),_:1})])])])}}},Le={class:"container"},je={class:"text-end"},qe={class:"table mb-3"},He=e("thead",null,[e("tr",null,[e("th",{width:"100"}," 文章建立時間 "),e("th",null," 文章標題 "),e("th",{width:"100"}," 作者 "),e("th",null," 標籤 "),e("th",{width:"100"}," 圖片 "),e("th",null," 文章描述 "),e("th",{width:"150"}," 是否發布 "),e("th",{width:"120"}," 編輯 ")])],-1),Ie={key:0,class:"d-flex flex-wrap"},Se=["src","alt"],Oe={class:"btn-group btn-group-sm",role:"group"},ze=["onClick"],Je=["onClick"],Ke={key:1},Qe=e("td",{class:"text-center",colspan:"100"}," 目前沒有文章唷!，新增一篇文章吧！ ",-1),Re=[Qe],ot={__name:"DashboardArticles",setup(d){const x=H("$swal"),w=f(null),b=f(null),t=f([]),u=f(null),h=(i=1)=>{Y(i).then(o=>{t.value=o.data.articles||[],u.value=o.data.pagination||{}}).catch(o=>{var l,m;x("",((m=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:m.message)||"有錯誤","error")})},U=i=>{b.value.hide(),te(i).then(({data:o})=>{x(`文章：${i}，${o.message} `),h()}).catch(o=>{var l,m;x("",((m=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:m.message)||"有錯誤","error")})},p=i=>{b.value.show({id:i.id,title:i.title})},M=(i,o)=>{w.value.show(i,{...o})};return I(()=>{h()}),(i,o)=>(c(),r(T,null,[v(Ge,{ref_key:"articleModel",ref:w,onGetArticles:h},null,512),e("div",Le,[e("div",je,[e("button",{class:"btn btn-secondary",onClick:o[0]||(o[0]=l=>M(!0))}," 新增文章 ")]),e("table",qe,[He,e("tbody",null,[t.value.length>0?(c(!0),r(T,{key:0},B(t.value,l=>{var m;return c(),r("tr",{key:l.id},[e("td",null,g(R(z)(l.create_at)),1),e("td",null,g(l.title),1),e("td",null,g(l.author),1),e("td",null,[((m=l==null?void 0:l.tag)==null?void 0:m.length)>0?(c(),r("div",Ie,[(c(!0),r(T,null,B(l.tag,(A,D)=>(c(),r("div",{key:D,class:"badge rounded-pill text-bg-info mb-2 me-2"},g(A),1))),128))])):G("",!0)]),e("td",null,[e("img",{width:"100",src:l.image,alt:l.title},null,8,Se)]),e("td",null,g(l.description),1),e("td",null,[e("div",{class:E(["form-check-label",{"text-success":l.isPublic}])},g(l.isPublic?"發布":"未發布"),3)]),e("td",null,[e("div",Oe,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:A=>M(!1,{...l})}," 檢視 ",8,ze),e("button",{type:"button",class:"btn btn-outline-danger",onClick:A=>p(l)}," 刪除 ",8,Je)])])])}),128)):(c(),r("tr",Ke,Re))])]),u.value?(c(),Q(O,{key:0,"current-page":u.value.current_page,"total-pages":u.value.total_pages,"has-next":u.value.has_next,"has-pre":u.value.has_pre,onGetPage:h},null,8,["current-page","total-pages","has-next","has-pre"])):G("",!0)]),v(X,{ref_key:"deleteArticleModal",ref:b,"modal-title":"文章",onDeleteMethod:U},null,512)],64))}};export{ot as default};
