import{P as T}from"./PaginationComponent-930fbe8c.js";import{s as C}from"./service-76d60509.js";import{g as w,c as x}from"./filters-87564b85.js";import{M as E}from"./modal-57346e3c.js";import{r as m,h as N,o,c as i,b as t,t as a,H as $,u as v,n as B,F as g,v as O,i as L,d as D,j as P}from"./index-5356cf8e.js";import{_ as j}from"./DeleteItemModal-42cbcbe9.js";import"./plugin-vueexport-helper-c27b6911.js";import"./component-functions-4ab743b4.js";function A(_=1){return C({method:"GET",url:`/admin/orders?page=${_}`})}function S(_){return C({method:"Delete",url:`/admin/order/${_}`})}function V(_){return C({method:"PUT",url:`/admin/order/${_.id}`,data:{data:_}})}const q={id:"modal",class:"modal fade modal-xl",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true"},F={class:"modal-dialog"},G={class:"modal-content border-0"},H=t("div",{class:"modal-header"},[t("h5",{id:"modalLabel",class:"modal-title"},[t("span",null,"檢視訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),z={class:"modal-body"},I={class:"row"},U={class:"col-md-4"},J=t("h3",null,"使用者資訊",-1),K={class:"table"},Q={key:0},R=t("th",{width:"80"}," 姓名 ",-1),W=t("th",null,"Email",-1),X=t("th",null,"電話",-1),Y=t("th",null,"地址",-1),Z={class:"col-md-8"},tt=t("h3",null,"訂單資訊",-1),et={class:"table"},st={key:0},lt=t("th",null,"編號",-1),at=t("th",{width:"100"}," 下單時間 ",-1),nt=t("th",{width:"100"}," 付款時間 ",-1),ot={key:0},dt={key:1},it=t("th",null,"是否付款",-1),ct=t("th",null," 總價 ",-1),ut=t("h3",null,"訂購的商品",-1),_t={class:"table"},ht={key:0},rt={width:"100"},pt={width:"100",class:"text-end"},mt={class:"d-flex justify-content-end"},vt={class:"form-check"},bt=["checked"],ft={class:"form-check-label",for:"payChecked"},kt={__name:"OrderModal",emits:["putOrder"],setup(_,{expose:r,emit:f}){const s=m(""),c=m(null),b=h=>{s.value=h,c.value.show()},p=()=>{c.value.hide(),s.value={}},y=h=>{s.value.is_paid=h.target.checked,f("putOrder",{...s.value},h)};return N(()=>{c.value=new E("#modal",{focus:!1})}),r({show:b}),(h,k)=>(o(),i("div",q,[t("div",F,[t("div",G,[H,t("div",z,[t("div",I,[t("div",U,[J,t("table",K,[s.value.user?(o(),i("tbody",Q,[t("tr",null,[R,t("td",null,a(s.value.user.name),1)]),t("tr",null,[W,t("td",null,a(s.value.user.email),1)]),t("tr",null,[X,t("td",null,a(s.value.user.tel),1)]),t("tr",null,[Y,t("td",null,a(s.value.user.address),1)])])):$("",!0)])]),t("div",Z,[tt,t("table",et,[s.value.user?(o(),i("tbody",st,[t("tr",null,[lt,t("td",null,a(s.value.id),1)]),t("tr",null,[at,t("td",null,a(v(w)(s.value.create_at)),1)]),t("tr",null,[nt,t("td",null,[s.value.paid_date?(o(),i("span",ot,a(v(w)(s.value.paid_date)),1)):(o(),i("span",dt," 時間格式錯誤 "))])]),t("tr",null,[it,t("td",{class:B([s.value.is_paid?"text-success":"text-danger"])},a(s.value.is_paid?"已付款":"未付款"),3)]),t("tr",null,[ct,t("td",null,a(`NTD ${v(x)(s.value.total)}`),1)])])):$("",!0)]),ut,t("table",_t,[s.value.products?(o(),i("tbody",ht,[(o(!0),i(g,null,O(s.value.products,u=>(o(),i("tr",{key:u.id},[t("th",null,a(u.product.title),1),t("td",rt,a(`${u.qty} / ${u.product.unit}`),1),t("td",pt,a(`NTD ${v(x)(u.final_total)}`),1)]))),128))])):$("",!0)]),t("div",mt,[t("div",vt,[t("input",{id:"payChecked",checked:s.value.is_paid,class:"form-check-input",type:"checkbox",onChange:k[0]||(k[0]=u=>y(u))},null,40,bt),t("label",ft,a(s.value.is_paid?"已付款":"未付款"),1)])])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-danger",onClick:p}," 確認 ")])])])]))}},$t={class:"container"},gt={class:"table mb-3"},yt=t("thead",null,[t("tr",null,[t("th",{width:"100"}," 購買時間 "),t("th",{width:"100"}," Email "),t("th",null," 購買款項 "),t("th",{width:"100"}," 應付金額 "),t("th",{width:"150"}," 是否付款 "),t("th",{width:"120"}," 編輯 ")])],-1),wt={class:"text-end"},xt={class:"form-check form-switch"},Ot=["id","checked","onChange"],Ct=["for"],Mt={class:"btn-group btn-group-sm",role:"group","aria-label":"Basic example"},Dt=["onClick"],Nt=["onClick"],Bt={key:1},Tt=t("td",{class:"text-center",colspan:"100"}," 目前沒有訂單唷!!! ",-1),Et=[Tt],Gt={__name:"DashboardOrders",setup(_){const r=L("$swal"),f=m(null),s=m([]),c=m(null),b=m(null),p=(d=1)=>{A(d).then(({data:n})=>{s.value=n.orders,c.value=n.pagination}).catch(n=>{var e,l;r("",((l=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:l.message)||"有錯誤","error")})},y=d=>{b.value.show({id:d.id,title:d.id})},h=(d,n)=>{d.is_paid=n.target.checked,V(d).then(({data:e})=>{r(`${e.message}，訂單號碼：${d.id}`),p()}).catch(e=>{var l,M;r("",((M=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:M.message)||"有錯誤","error")})},k=d=>{b.value.hide(),S(d).then(({data:n})=>{r(`訂單：${d}，${n.message} `),p()}).catch(n=>{var e,l;r("",((l=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:l.message)||"有錯誤","error")})},u=d=>{f.value.show(d)};return N(()=>{p()}),(d,n)=>(o(),i(g,null,[D(kt,{ref_key:"orderModel",ref:f,onPutOrder:h},null,512),t("div",$t,[t("table",gt,[yt,t("tbody",null,[s.value.length>0?(o(!0),i(g,{key:0},O(s.value,e=>(o(),i("tr",{key:e.id},[t("td",null,a(v(w)(e.create_at)),1),t("td",null,a(e==null?void 0:e.user.email),1),t("td",null,[t("ul",null,[(o(!0),i(g,null,O(e.products,l=>(o(),i("li",{key:l.id},a(`${l.product.title}: ${l.product.price} * ${l.qty} = ${l.final_total}`),1))),128))])]),t("td",wt," NTD "+a(v(x)(e.total)),1),t("td",null,[t("div",xt,[t("input",{id:`customSwitch${e.id}`,checked:e.is_paid,class:"form-check-input",type:"checkbox",onChange:l=>h(e,l)},null,40,Ot),t("label",{class:B(["form-check-label",{"text-success":e.is_paid}]),for:`customSwitch${e.id}`},a(e.is_paid?"已付款":"未付款"),11,Ct)])]),t("td",null,[t("div",Mt,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:l=>u({...e})}," 檢視 ",8,Dt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:l=>y(e)}," 刪除 ",8,Nt)])])]))),128)):(o(),i("tr",Bt,Et))])]),c.value?(o(),P(T,{key:0,"current-page":c.value.current_page,"total-pages":c.value.total_pages,"has-next":c.value.has_next,"has-pre":c.value.has_pre,onGetItems:p},null,8,["current-page","total-pages","has-next","has-pre"])):$("",!0)]),D(j,{ref_key:"deleteOrderModal",ref:b,"modal-title":"訂單",onDeleteMethod:k},null,512)],64))}};export{Gt as default};
