import{P as M}from"./PaginationComponent-5fa6f0f5.js";import{s as x}from"./service-0b83a29a.js";import{g as y,c as g}from"./filters-87564b85.js";import{M as N}from"./modal-89e87d01.js";import{r as p,d as C,o as n,c as d,a as t,t as s,I as k,u as h,H as O,F as f,p as w,i as B,f as T,h as D}from"./index-dab51377.js";import"./tools-f017d837.js";import"./plugin-vueexport-helper-c27b6911.js";function E(u=1){return x({method:"GET",url:`/admin/orders?page=${u}`})}function L(u){return x({method:"Delete",url:`/admin/order/${u}`})}function P(u){return x({method:"PUT",url:`/admin/order/${u.id}`,data:{data:u}})}const A={id:"modal",class:"modal fade modal-xl",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true"},S={class:"modal-dialog"},V={class:"modal-content border-0"},j=t("div",{class:"modal-header"},[t("h5",{id:"modalLabel",class:"modal-title"},[t("span",null,"檢視訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},F={class:"row"},G={class:"col-md-4"},H=t("h3",null,"使用者資訊",-1),I={class:"table"},z={key:0},U=t("th",{width:"80"}," 姓名 ",-1),J=t("th",null,"Email",-1),K=t("th",null,"電話",-1),Q=t("th",null,"地址",-1),R={class:"col-md-8"},W=t("h3",null,"訂單資訊",-1),X={class:"table"},Y={key:0},Z=t("th",null,"編號",-1),tt=t("th",{width:"100"}," 下單時間 ",-1),et=t("th",{width:"100"}," 付款時間 ",-1),st={key:0},lt={key:1},at=t("th",null,"是否付款",-1),nt=t("th",null," 總價 ",-1),ot=t("h3",null,"訂購的商品",-1),dt={class:"table"},ct={key:0},it={width:"100"},ut={width:"100",class:"text-end"},rt={class:"d-flex justify-content-end"},_t={class:"form-check"},ht=["checked"],pt={class:"form-check-label",for:"payChecked"},mt={__name:"OrderModal",emits:["putOrder"],setup(u,{expose:m,emit:v}){const e=p(""),c=p(null),_=r=>{e.value=r,c.value.show()},b=()=>{c.value.hide(),e.value={}},$=r=>{e.value.is_paid=r.target.checked,v("putOrder",{...e.value},r)};return C(()=>{c.value=new N("#modal",{focus:!1})}),m({show:_}),(r,o)=>(n(),d("div",A,[t("div",S,[t("div",V,[j,t("div",q,[t("div",F,[t("div",G,[H,t("table",I,[e.value.user?(n(),d("tbody",z,[t("tr",null,[U,t("td",null,s(e.value.user.name),1)]),t("tr",null,[J,t("td",null,s(e.value.user.email),1)]),t("tr",null,[K,t("td",null,s(e.value.user.tel),1)]),t("tr",null,[Q,t("td",null,s(e.value.user.address),1)])])):k("",!0)])]),t("div",R,[W,t("table",X,[e.value.user?(n(),d("tbody",Y,[t("tr",null,[Z,t("td",null,s(e.value.id),1)]),t("tr",null,[tt,t("td",null,s(h(y)(e.value.create_at)),1)]),t("tr",null,[et,t("td",null,[e.value.paid_date?(n(),d("span",st,s(h(y)(e.value.paid_date)),1)):(n(),d("span",lt," 時間格式錯誤 "))])]),t("tr",null,[at,t("td",{class:O([e.value.is_paid?"text-success":"text-danger"])},s(e.value.is_paid?"已付款":"未付款"),3)]),t("tr",null,[nt,t("td",null,s(`NT ${h(g)(e.value.total)}`),1)])])):k("",!0)]),ot,t("table",dt,[e.value.products?(n(),d("tbody",ct,[(n(!0),d(f,null,w(e.value.products,a=>(n(),d("tr",{key:a.id},[t("th",null,s(a.product.title),1),t("td",it,s(`${a.qty} / ${a.product.unit}`),1),t("td",ut,s(`NT ${h(g)(a.final_total)}`),1)]))),128))])):k("",!0)]),t("div",rt,[t("div",_t,[t("input",{id:"payChecked",checked:e.value.is_paid,class:"form-check-input",type:"checkbox",onChange:o[0]||(o[0]=a=>$(a))},null,40,ht),t("label",pt,s(e.value.is_paid?"已付款":"未付款"),1)])])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-danger",onClick:b}," 確認 ")])])])]))}},vt={class:"container"},bt={class:"table mb-3"},kt=t("thead",null,[t("tr",null,[t("th",{width:"100"}," 購買時間 "),t("th",{width:"100"}," Email "),t("th",null," 購買款項 "),t("th",{width:"100"}," 應付金額 "),t("th",{width:"150"}," 是否付款 "),t("th",{width:"120"}," 編輯 ")])],-1),ft={class:"text-end"},$t={class:"form-check form-switch"},yt=["id","checked","onChange"],gt=["for"],wt={class:"btn-group btn-group-sm",role:"group","aria-label":"Basic example"},xt=["onClick"],Ct=["onClick"],Ot={key:1},Mt=t("td",{class:"text-center",colspan:"100"}," 目前沒有訂單唷!!! ",-1),Nt=[Mt],St={__name:"DashboardOrders",setup(u){const m=B("$swal"),v=p(null),e=p([]),c=p(null),_=(o=1)=>{E(o).then(({data:a})=>{e.value=a.orders,c.value=a.pagination}).catch()},b=(o,a)=>{o.is_paid=a.target.checked,P(o).then(({data:l})=>{m(`${l.message}，訂單號碼：${o.id}`),_()}).catch()},$=o=>{L(o).then(({data:a})=>{m(`訂單：${o}，${a.message} `),_()}).catch()},r=o=>{v.value.show(o)};return C(()=>{_()}),(o,a)=>(n(),d(f,null,[T(mt,{ref_key:"orderModel",ref:v,onPutOrder:b},null,512),t("div",vt,[t("table",bt,[kt,t("tbody",null,[e.value.length>0?(n(!0),d(f,{key:0},w(e.value,l=>(n(),d("tr",{key:l.id},[t("td",null,s(h(y)(l.create_at)),1),t("td",null,s(l==null?void 0:l.user.email),1),t("td",null,[t("ul",null,[(n(!0),d(f,null,w(l.products,i=>(n(),d("li",{key:i.id},s(`${i.product.title}: ${i.product.price} * ${i.qty} = ${i.final_total}`),1))),128))])]),t("td",ft," NT "+s(h(g)(l.total)),1),t("td",null,[t("div",$t,[t("input",{id:`customSwitch${l.id}`,checked:l.is_paid,class:"form-check-input",type:"checkbox",onChange:i=>b(l,i)},null,40,yt),t("label",{class:O(["form-check-label",{"text-success":l.is_paid}]),for:`customSwitch${l.id}`},s(l.is_paid?"已付款":"未付款"),11,gt)])]),t("td",null,[t("div",wt,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:i=>r({...l})}," 檢視 ",8,xt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:i=>$(l.id)}," 刪除 ",8,Ct)])])]))),128)):(n(),d("tr",Ot,Nt))])]),c.value?(n(),D(M,{key:0,"current-page":c.value.current_page,"total-pages":c.value.total_pages,"has-next":c.value.has_next,"has-pre":c.value.has_pre,onGetItems:_},null,8,["current-page","total-pages","has-next","has-pre"])):k("",!0)])],64))}};export{St as default};
