import{P as N}from"./PaginationComponent-2d1c0997.js";import{s as k}from"./service-1ceeacb1.js";import{g as I}from"./filters-2b4b10a0.js";import{K as E,k as _,b as D,o as i,c as d,d as t,t as m,C as h,M as b,F as w,m as P,G as M,O as F,e as H,f as O,u as S,E as j}from"./index-ebf53b5d.js";import{M as z}from"./modal-cb46425a.js";import"./tools-f017d837.js";import"./plugin-vueexport-helper-c27b6911.js";function K(n=1){return k({method:"GET",url:`/admin/articles?page=${n}`})}function q(n){return k({method:"GET",url:`/admin/article/${n}`})}function J(n){return k({method:"PUT",url:`/admin/article/${n.id}`,data:{data:n}})}function Q(n){return k({method:"DELETE",url:`/admin/article/${n}`})}function R(n){return k({method:"POST",url:"/admin/article",data:{data:n}})}const V="/yfarm/assets/noImage-f4958a46.png",W={id:"modal",class:"modal fade modal-xl",tabindex:"-1","aria-hidden":"true"},X={class:"modal-dialog"},Y={class:"modal-content border-0"},Z={class:"modal-header"},tt={id:"modalLabel",class:"modal-title"},et=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),lt={class:"modal-body"},st={class:"row"},ot={class:"col-md-6"},at={class:"mb-3"},nt=t("label",{for:"title",class:"form-label"},"標題",-1),it={class:"mb-3"},ct=t("label",{for:"author",class:"form-label"},"作者",-1),dt={class:"mb-3"},rt=t("label",{for:"description",class:"form-label"},"描述",-1),ut={class:"mb-3"},mt=t("label",{for:"tempTag",class:"form-label"},"標籤",-1),ht={class:"input-group mb-3"},_t=["disabled"],pt={key:0,class:"d-flex flex-wrap"},vt=["onClick"],bt=t("div",{class:"text-warning"},[t("span",null,"再點一次，就取消。")],-1),gt={class:"mb-3"},ft={class:"form-check"},yt=t("label",{class:"form-check-label",for:"isPublic"},"是否發布",-1),kt={class:"col-md-6"},xt={class:"mb-2"},$t={class:"mb-3"},wt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),At=["src"],Ct={class:"mb-3"},Pt=t("label",{for:"content",class:"form-label"},"內容",-1),Mt={__name:"ModifyArticlesModal",emits:["getArticles"],setup(n,{expose:A,emit:g}){const p=E("$swal"),e=_({}),u=_(null),v=_(!1),x=(r,s)=>{v.value=r,v.value?(e.value=s,u.value.show()):q(s.id).then(({data:y})=>{console.log(y),e.value=y.article,u.value.show()})},o=_(""),c=()=>{e.value={},o.value=""},l=()=>{u.value.hide(),c()},$=()=>{J(e.value).then(({data:r})=>{p(r.message),g("getArticles"),l()}).catch()},f=()=>{e.value.isPublic===void 0&&(e.value.isPublic=!1),e.value={...e.value,create_at:new Date().getTime()},R(e.value).then(({data:r})=>{p(r.message),g("getArticles"),l()}).catch()},C=()=>{v.value?f():$()},G=()=>{if(o.value==="")return!1;e.value.tag===void 0&&(e.value.tag=[]),e.value.tag.push(o.value),o.value=""},B=r=>{e.value.tag.splice(r,1)},L=r=>{console.log("onimgerror",V),r.target.src=V};return D(()=>{u.value=new z("#modal",{focus:!1})}),A({show:x}),(r,s)=>{var y,T;return i(),d("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("h5",tt,m(v.value?"新增":"修改")+"文章 ",1),et]),t("div",lt,[t("div",st,[t("div",ot,[t("div",at,[nt,h(t("input",{id:"title","onUpdate:modelValue":s[0]||(s[0]=a=>e.value.title=a),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[b,e.value.title]])]),t("div",it,[ct,h(t("input",{id:"author","onUpdate:modelValue":s[1]||(s[1]=a=>e.value.author=a),type:"text",class:"form-control",placeholder:"請輸入作者"},null,512),[[b,e.value.author]])]),t("div",dt,[rt,h(t("input",{id:"description","onUpdate:modelValue":s[2]||(s[2]=a=>e.value.description=a),type:"text",class:"form-control",placeholder:"請輸入描述"},null,512),[[b,e.value.description]])]),t("div",ut,[mt,t("div",ht,[h(t("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>o.value=a),type:"text",class:"form-control",placeholder:"輸入標籤"},null,512),[[b,o.value]]),t("button",{disabled:o.value==="",class:"btn btn-outline-secondary",type:"button",onClick:G}," 輸入 ",8,_t)]),((T=(y=e.value)==null?void 0:y.tag)==null?void 0:T.length)>0?(i(),d("div",pt,[(i(!0),d(w,null,P(e.value.tag,(a,U)=>(i(),d("button",{key:U,class:"btn btn-sm btn-outline-info mb-2 me-2",onClick:Ot=>B(U)},m(a),9,vt))),128)),bt])):M("",!0)]),t("div",gt,[t("div",ft,[h(t("input",{id:"isPublic","onUpdate:modelValue":s[4]||(s[4]=a=>e.value.isPublic=a),class:"form-check-input",type:"checkbox"},null,512),[[F,e.value.isPublic]]),yt])])]),t("div",kt,[t("div",xt,[t("div",$t,[wt,h(t("input",{id:"imageUrl","onUpdate:modelValue":s[5]||(s[5]=a=>e.value.image=a),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[b,e.value.image]])]),t("img",{class:"img-fluid",src:e.value.image,alt:"image",onError:L},null,40,At)])])]),t("div",null,[t("div",Ct,[Pt,h(t("textarea",{id:"content","onUpdate:modelValue":s[6]||(s[6]=a=>e.value.content=a),type:"text",class:"form-control",placeholder:"請輸入內容"},null,512),[[b,e.value.content]])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:l}," 取消 "),t("button",{type:"button",class:"btn btn-secondary",onClick:C}," 確認 ")])])])])}}},Tt={class:"container"},Ut={class:"text-end"},Vt={class:"table mb-3"},Et=t("thead",null,[t("tr",null,[t("th",{width:"100"}," 文章建立時間 "),t("th",null," 文章標題 "),t("th",{width:"100"}," 作者 "),t("th",null," 標籤 "),t("th",{width:"100"}," 圖片 "),t("th",null," 文章描述 "),t("th",{width:"150"}," 是否發布 "),t("th",{width:"120"}," 編輯 ")])],-1),Dt={key:0,class:"d-flex flex-wrap"},Gt=["src","alt"],Bt={class:"btn-group btn-group-sm",role:"group"},Lt=["onClick"],Nt=["onClick"],It={key:1},Ft=t("td",{class:"text-center",colspan:"100"}," 目前沒有文章唷!，新增一篇文章吧！ ",-1),Ht=[Ft],Rt={__name:"DashboardArticles",setup(n){const A=E("$swal"),g=_(null),p=_([]),e=_(null),u=(o=1)=>{console.log(o),K(o).then(c=>{p.value=c.data.articles||[],e.value=c.data.pagination||{}}).catch()},v=o=>{Q(o).then(({data:c})=>{A(`文章：${o}，${c.message} `),u()}).catch()},x=(o,c)=>{g.value.show(o,{...c})};return D(()=>{u()}),(o,c)=>(i(),d(w,null,[H(Mt,{ref_key:"articleModel",ref:g,onGetArticles:u},null,512),t("div",Tt,[t("div",Ut,[t("button",{class:"btn btn-secondary",onClick:c[0]||(c[0]=l=>x(!0))}," 新增文章 ")]),t("table",Vt,[Et,t("tbody",null,[p.value.length>0?(i(!0),d(w,{key:0},P(p.value,l=>{var $;return i(),d("tr",{key:l.id},[t("td",null,m(S(I)(l.create_at)),1),t("td",null,m(l.title),1),t("td",null,m(l.author),1),t("td",null,[(($=l==null?void 0:l.tag)==null?void 0:$.length)>0?(i(),d("div",Dt,[(i(!0),d(w,null,P(l.tag,(f,C)=>(i(),d("div",{key:C,class:"badge rounded-pill text-bg-info mb-2 me-2"},m(f),1))),128))])):M("",!0)]),t("td",null,[t("img",{width:"100",src:l.image,alt:l.title},null,8,Gt)]),t("td",null,m(l.description),1),t("td",null,[t("div",{class:j(["form-check-label",{"text-success":l.isPublic}])},m(l.isPublic?"發布":"未發布"),3)]),t("td",null,[t("div",Bt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:f=>x(!1,{...l})}," 檢視 ",8,Lt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:f=>v(l.id)}," 刪除 ",8,Nt)])])])}),128)):(i(),d("tr",It,Ht))])]),e.value?(i(),O(N,{key:0,"current-page":e.value.current_page,"total-pages":e.value.total_pages,"has-next":e.value.has_next,"has-pre":e.value.has_pre,onGetPage:u},null,8,["current-page","total-pages","has-next","has-pre"])):M("",!0)])],64))}};export{Rt as default};
