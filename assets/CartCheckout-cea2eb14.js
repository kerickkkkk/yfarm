import{J as S,L as $,i as E,s as L,r as G,h as M,a as u,o as _,c as p,d as l,b as e,u as d,F as x,v as O,k as c,w as y,t as i,n as v,E as R,M as X}from"./index-5356cf8e.js";import{c as j}from"./filters-87564b85.js";import{u as z}from"./cartsStore-89c1c65c.js";import{_ as A}from"./CartStep-a2b040b7.js";import{s as J}from"./service-76d60509.js";import{B as P}from"./BannerView-4f5638bb.js";import"./plugin-vueexport-helper-c27b6911.js";function H(f){return J({method:"POST",url:"/order",data:f})}const I={class:"container"},K=e("section",{class:"step d-md-flex"},null,-1),Q={class:"container mt-5"},W={class:"row"},Y={class:"col-md-6"},Z={class:"row"},ee={class:"table"},se=e("thead",null,[e("tr",null,[e("th",{scope:"col"}," 商品選項 "),e("th",{scope:"col",class:"text-end"}," 單價 X 數量 "),e("th",{scope:"col",class:"text-end"}," 小計 ")])],-1),te={class:"cart__title d-flex"},ae={class:"me-3"},le=["src","alt"],oe={class:"cart__title__content"},ne={class:"h6"},de={class:"text-end"},ie={class:"text-end"},ce={key:1},re={colspan:"100",class:"text-center"},me={class:"text-end",colspan:"100"},ue={class:"text-end",colspan:"100"},_e={class:"col-md-6"},pe={class:"mb-3"},ve=e("label",{for:"name",class:"form-label"},[e("span",{class:"text-danger"},"*"),c(" 姓名")],-1),fe={class:"mb-3"},he=e("label",{for:"email",class:"form-label"},[e("span",{class:"text-danger"},"*"),c(" Email")],-1),be={class:"mb-3"},Ve=e("label",{for:"tel",class:"form-label"},[e("span",{class:"text-danger"},"*"),c(" 電話")],-1),ge={class:"mb-3"},xe=e("label",{for:"address",class:"form-label"},[e("span",{class:"text-danger"},"*"),c(" 地址")],-1),ye={class:"mb-3"},ke=e("label",{for:"message",class:"form-label"},"留言",-1),we=e("button",{class:"btn btn-secondary",type:"submit"}," 送出訂單 ",-1),Be={__name:"CartCheckout",setup(f){const k=S(),w=$(),T=E("$swal"),h=z(),{getCarts:b}=h,{cartsGetter:V,totalGetter:U,finalTotalGetter:C}=L(h),D=k.meta.step,F={name:"",email:"",tel:"",address:"",message:""},s=G({name:"",email:"",tel:"",address:"",message:""}),N=()=>{s.value={...F.value}},q=()=>{const g={data:{user:{name:s.value.name,tel:s.value.tel,email:s.value.email,address:s.value.address},message:s.value.message}};H(g).then(t=>{t.data.success&&(N(),b(),w.push("/finish"))}).catch(t=>{var r,n;T("",((n=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:n.message)||"有錯誤","error")})};return M(()=>{b()}),(g,t)=>{const r=u("routerLink"),n=u("VField"),m=u("error-message"),B=u("VForm");return _(),p(x,null,[l(P),e("div",I,[l(A,{step:d(D)},null,8,["step"])]),K,e("div",Q,[e("div",W,[e("div",Y,[e("div",Z,[e("table",ee,[se,e("tbody",null,[d(V).length>0?(_(!0),p(x,{key:0},O(d(V),a=>(_(),p("tr",{key:a.id},[e("th",null,[e("div",te,[e("div",ae,[e("img",{src:a.product.imageUrl,alt:a.product.title,width:"50",class:"img-fluid"},null,8,le)]),e("div",oe,[e("div",ne,i(a.product.title),1)])])]),e("td",de,i(d(j)(a.product.price))+" X "+i(a.qty),1),e("td",ie," NTD $"+i(a.final_total),1)]))),128)):(_(),p("tr",ce,[e("td",re,[c(" 購物車沒有東西 "),l(r,{to:"/products"},{default:y(()=>[c(" 挑選產品去 ")]),_:1})])]))]),e("tfoot",null,[e("tr",null,[e("td",me," 原價 NTD $ "+i(d(U)),1)]),e("tr",null,[e("td",ue," 總價 NTD $ "+i(d(C)),1)])])])])]),e("div",_e,[l(B,{onSubmit:q},{default:y(({errors:a})=>[e("div",pe,[ve,l(n,{id:"name",modelValue:s.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.name=o),name:"姓名",type:"text",class:v(["form-control",{"is-invalid":a.姓名}]),placeholder:"請輸入 姓名",rules:"required"},null,8,["modelValue","class"]),l(m,{name:"姓名",class:"invalid-feedback"})]),e("div",fe,[he,l(n,{id:"email",modelValue:s.value.email,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.email=o),name:"email",type:"email",class:v(["form-control",{"is-invalid":a.email}]),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),l(m,{name:"email",class:"invalid-feedback"})]),e("div",be,[Ve,l(n,{id:"tel",modelValue:s.value.tel,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.tel=o),name:"電話",type:"tel",class:v(["form-control",{"is-invalid":a.電話}]),placeholder:"請輸入 電話",rules:"required|min:8|max:10"},null,8,["modelValue","class"]),l(m,{name:"電話",class:"invalid-feedback"})]),e("div",ge,[xe,l(n,{id:"address",modelValue:s.value.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.address=o),name:"地址",type:"text",class:v(["form-control",{"is-invalid":a.地址}]),placeholder:"請輸入 地址",rules:"required"},null,8,["modelValue","class"]),l(m,{modelValue:s.value.address,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.address=o),name:"地址",class:"invalid-feedback"},null,8,["modelValue"])]),e("div",ye,[ke,R(e("textarea",{id:"message","onUpdate:modelValue":t[5]||(t[5]=o=>s.value.message=o),class:"form-control",placeholder:"請輸入 留言","aria-describedby":"message"},null,512),[[X,s.value.message]])]),we]),_:1})])])])],64)}}};export{Be as default};
