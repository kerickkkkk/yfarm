import{P as L}from"./PaginationComponent-1aabbbc2.js";import{s as y}from"./service-37dadeab.js";import{g as N}from"./filters-2b4b10a0.js";import{K as V,k as _,b as E,o as i,c as d,d as t,t as m,C as h,M as b,F as w,m as P,G as M,O as I,e as F,f as H,u as O,E as S}from"./index-4791cd43.js";import{M as j}from"./modal-29f22972.js";import"./tools-f017d837.js";import"./plugin-vueexport-helper-c27b6911.js";function z(n=1){return y({method:"GET",url:`/admin/articles?page=${n}`})}function K(n){return y({method:"GET",url:`/admin/article/${n}`})}function q(n){return y({method:"PUT",url:`/admin/article/${n.id}`,data:{data:n}})}function J(n){return y({method:"DELETE",url:`/admin/article/${n}`})}function Q(n){return y({method:"POST",url:"/admin/article",data:{data:n}})}const R="/yfarm/assets/noImage-f4958a46.png",W={id:"modal",class:"modal fade modal-xl",tabindex:"-1","aria-hidden":"true"},X={class:"modal-dialog"},Y={class:"modal-content border-0"},Z={class:"modal-header"},tt={id:"modalLabel",class:"modal-title"},et=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),lt={class:"modal-body"},st={class:"row"},ot={class:"col-md-6"},at={class:"mb-3"},nt=t("label",{for:"title",class:"form-label"},"標題",-1),it={class:"mb-3"},ct=t("label",{for:"author",class:"form-label"},"作者",-1),dt={class:"mb-3"},ut=t("label",{for:"description",class:"form-label"},"描述",-1),rt={class:"mb-3"},mt=t("label",{for:"tempTag",class:"form-label"},"標籤",-1),ht={class:"input-group mb-3"},_t=["disabled"],pt={key:0,class:"d-flex flex-wrap"},vt=["onClick"],bt=t("div",{class:"text-warning"},[t("span",null,"再點一次，就取消。")],-1),ft={class:"mb-3"},gt={class:"form-check"},yt=t("label",{class:"form-check-label",for:"isPublic"},"是否發布",-1),kt={class:"col-md-6"},xt={class:"mb-2"},$t={class:"mb-3"},wt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),At=["src"],Ct={class:"mb-3"},Pt=t("label",{for:"content",class:"form-label"},"內容",-1),Mt={__name:"ModifyArticlesModal",emits:["getArticles"],setup(n,{expose:A,emit:f}){const p=V("$swal"),e=_({}),r=_(null),v=_(!1),k=(u,s)=>{v.value=u,v.value?(e.value=s,r.value.show()):K(s.id).then(({data:$})=>{e.value=$.article,r.value.show()})},o=_(""),c=()=>{e.value={},o.value=""},l=()=>{r.value.hide(),c()},x=()=>{q(e.value).then(({data:u})=>{p(u.message),f("getArticles"),l()}).catch()},g=()=>{e.value.isPublic===void 0&&(e.value.isPublic=!1),e.value={...e.value,create_at:new Date().getTime()},Q(e.value).then(({data:u})=>{p(u.message),f("getArticles"),l()}).catch()},C=()=>{v.value?g():x()},D=()=>{if(o.value==="")return!1;e.value.tag===void 0&&(e.value.tag=[]),e.value.tag.push(o.value),o.value=""},G=u=>{e.value.tag.splice(u,1)},B=u=>{u.target.src=R};return E(()=>{r.value=new j("#modal",{focus:!1})}),A({show:k}),(u,s)=>{var $,T;return i(),d("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("h5",tt,m(v.value?"新增":"修改")+"文章 ",1),et]),t("div",lt,[t("div",st,[t("div",ot,[t("div",at,[nt,h(t("input",{id:"title","onUpdate:modelValue":s[0]||(s[0]=a=>e.value.title=a),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[b,e.value.title]])]),t("div",it,[ct,h(t("input",{id:"author","onUpdate:modelValue":s[1]||(s[1]=a=>e.value.author=a),type:"text",class:"form-control",placeholder:"請輸入作者"},null,512),[[b,e.value.author]])]),t("div",dt,[ut,h(t("input",{id:"description","onUpdate:modelValue":s[2]||(s[2]=a=>e.value.description=a),type:"text",class:"form-control",placeholder:"請輸入描述"},null,512),[[b,e.value.description]])]),t("div",rt,[mt,t("div",ht,[h(t("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>o.value=a),type:"text",class:"form-control",placeholder:"輸入標籤"},null,512),[[b,o.value]]),t("button",{disabled:o.value==="",class:"btn btn-outline-secondary",type:"button",onClick:D}," 輸入 ",8,_t)]),((T=($=e.value)==null?void 0:$.tag)==null?void 0:T.length)>0?(i(),d("div",pt,[(i(!0),d(w,null,P(e.value.tag,(a,U)=>(i(),d("button",{key:U,class:"btn btn-sm btn-outline-info mb-2 me-2",onClick:Ot=>G(U)},m(a),9,vt))),128)),bt])):M("",!0)]),t("div",ft,[t("div",gt,[h(t("input",{id:"isPublic","onUpdate:modelValue":s[4]||(s[4]=a=>e.value.isPublic=a),class:"form-check-input",type:"checkbox"},null,512),[[I,e.value.isPublic]]),yt])])]),t("div",kt,[t("div",xt,[t("div",$t,[wt,h(t("input",{id:"imageUrl","onUpdate:modelValue":s[5]||(s[5]=a=>e.value.image=a),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[b,e.value.image]])]),t("img",{class:"img-fluid",src:e.value.image,alt:"image",onError:B},null,40,At)])])]),t("div",null,[t("div",Ct,[Pt,h(t("textarea",{id:"content","onUpdate:modelValue":s[6]||(s[6]=a=>e.value.content=a),type:"text",class:"form-control",placeholder:"請輸入內容"},null,512),[[b,e.value.content]])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:l}," 取消 "),t("button",{type:"button",class:"btn btn-secondary",onClick:C}," 確認 ")])])])])}}},Tt={class:"container"},Ut={class:"text-end"},Vt={class:"table mb-3"},Et=t("thead",null,[t("tr",null,[t("th",{width:"100"}," 文章建立時間 "),t("th",null," 文章標題 "),t("th",{width:"100"}," 作者 "),t("th",null," 標籤 "),t("th",{width:"100"}," 圖片 "),t("th",null," 文章描述 "),t("th",{width:"150"}," 是否發布 "),t("th",{width:"120"}," 編輯 ")])],-1),Dt={key:0,class:"d-flex flex-wrap"},Gt=["src","alt"],Bt={class:"btn-group btn-group-sm",role:"group"},Lt=["onClick"],Nt=["onClick"],It={key:1},Ft=t("td",{class:"text-center",colspan:"100"}," 目前沒有文章唷!，新增一篇文章吧！ ",-1),Ht=[Ft],Rt={__name:"DashboardArticles",setup(n){const A=V("$swal"),f=_(null),p=_([]),e=_(null),r=(o=1)=>{z(o).then(c=>{p.value=c.data.articles||[],e.value=c.data.pagination||{}}).catch()},v=o=>{J(o).then(({data:c})=>{A(`文章：${o}，${c.message} `),r()}).catch()},k=(o,c)=>{f.value.show(o,{...c})};return E(()=>{r()}),(o,c)=>(i(),d(w,null,[F(Mt,{ref_key:"articleModel",ref:f,onGetArticles:r},null,512),t("div",Tt,[t("div",Ut,[t("button",{class:"btn btn-secondary",onClick:c[0]||(c[0]=l=>k(!0))}," 新增文章 ")]),t("table",Vt,[Et,t("tbody",null,[p.value.length>0?(i(!0),d(w,{key:0},P(p.value,l=>{var x;return i(),d("tr",{key:l.id},[t("td",null,m(O(N)(l.create_at)),1),t("td",null,m(l.title),1),t("td",null,m(l.author),1),t("td",null,[((x=l==null?void 0:l.tag)==null?void 0:x.length)>0?(i(),d("div",Dt,[(i(!0),d(w,null,P(l.tag,(g,C)=>(i(),d("div",{key:C,class:"badge rounded-pill text-bg-info mb-2 me-2"},m(g),1))),128))])):M("",!0)]),t("td",null,[t("img",{width:"100",src:l.image,alt:l.title},null,8,Gt)]),t("td",null,m(l.description),1),t("td",null,[t("div",{class:S(["form-check-label",{"text-success":l.isPublic}])},m(l.isPublic?"發布":"未發布"),3)]),t("td",null,[t("div",Bt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:g=>k(!1,{...l})}," 檢視 ",8,Lt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:g=>v(l.id)}," 刪除 ",8,Nt)])])])}),128)):(i(),d("tr",It,Ht))])]),e.value?(i(),H(L,{key:0,"current-page":e.value.current_page,"total-pages":e.value.total_pages,"has-next":e.value.has_next,"has-pre":e.value.has_pre,onGetPage:r},null,8,["current-page","total-pages","has-next","has-pre"])):M("",!0)])],64))}};export{Rt as default};
