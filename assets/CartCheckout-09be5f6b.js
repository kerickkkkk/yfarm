import{K as S,M as D,s as $,r as E,d as G,e as c,o as m,c as u,f as a,a as e,u as d,F as V,p as L,j as g,g as x,t as n,H as _,w as M,v as O}from"./index-dab51377.js";import{c as R}from"./filters-87564b85.js";import{u as X}from"./cartsStore-3bc1f7e3.js";import{_ as j}from"./CartStep-0f18b062.js";import{s as z}from"./service-0b83a29a.js";import{B as A}from"./BannerView-c81055b0.js";import"./plugin-vueexport-helper-c27b6911.js";function H(p){return z({method:"POST",url:"/order",data:p})}const K={class:"container"},P=e("section",{class:"step d-md-flex"},null,-1),I={class:"container mt-5"},J={class:"row"},Q={class:"col-md-6"},W={class:"row"},Y={class:"table"},Z=e("thead",null,[e("tr",null,[e("th",{scope:"col"}," 商品選項 "),e("th",{scope:"col",class:"text-end"}," 單價 X 數量 "),e("th",{scope:"col",class:"text-end"}," 小計 ")])],-1),ee={class:"cart__title d-flex"},se={class:"me-3"},te=["src","alt"],le={class:"cart__title__content"},ae={class:"h6"},oe={class:"text-end"},de={class:"text-end"},ne={key:1},ie={colspan:"100",class:"text-center"},re={class:"text-end",colspan:"100"},ce={class:"text-end",colspan:"100"},me={class:"col-md-6"},ue={class:"mb-3"},_e=e("label",{for:"name",class:"form-label"},"姓名",-1),pe={class:"mb-3"},ve=e("label",{for:"email",class:"form-label"},"Email",-1),fe={class:"mb-3"},he=e("label",{for:"tel",class:"form-label"},"電話",-1),be={class:"mb-3"},Ve=e("label",{for:"address",class:"form-label"},"地址",-1),ge={class:"mb-3"},xe=e("label",{for:"message",class:"form-label"},"留言",-1),ye=e("button",{class:"btn btn-secondary",type:"submit"}," 送出訂單 ",-1),qe={__name:"CartCheckout",setup(p){const y=S(),k=D(),v=X(),{getCarts:f}=v,{cartsGetter:h,totalGetter:T,finalTotalGetter:U}=$(v),w=y.meta.step,C={name:"",email:"",tel:"",address:"",message:""},s=E({name:"",email:"",tel:"",address:"",message:""}),F=()=>{s.value={...C.value}},N=()=>{const b={data:{user:{name:s.value.name,tel:s.value.tel,email:s.value.email,address:s.value.address},message:s.value.message}};H(b).then(t=>{t.data.success&&(F(),f(),k.push("/finish"))}).catch()};return G(()=>{f()}),(b,t)=>{const q=c("routerLink"),i=c("VField"),r=c("error-message"),B=c("VForm");return m(),u(V,null,[a(A),e("div",K,[a(j,{step:d(w)},null,8,["step"])]),P,e("div",I,[e("div",J,[e("div",Q,[e("div",W,[e("table",Y,[Z,e("tbody",null,[d(h).length>0?(m(!0),u(V,{key:0},L(d(h),l=>(m(),u("tr",{key:l.id},[e("th",null,[e("div",ee,[e("div",se,[e("img",{src:l.product.imageUrl,alt:l.product.title,width:"50",class:"img-fluid"},null,8,te)]),e("div",le,[e("div",ae,n(l.product.title),1)])])]),e("td",oe,n(d(R)(l.product.price))+" X "+n(l.qty),1),e("td",de," NT $"+n(l.final_total),1)]))),128)):(m(),u("tr",ne,[e("td",ie,[g(" 購物車沒有東西 "),a(q,{to:"/products"},{default:x(()=>[g(" 挑選產品去 ")]),_:1})])]))]),e("tfoot",null,[e("tr",null,[e("td",re," 原價 NT $ "+n(d(T)),1)]),e("tr",null,[e("td",ce," 總價 NT $ "+n(d(U)),1)])])])])]),e("div",me,[a(B,{onSubmit:N},{default:x(({errors:l})=>[e("div",ue,[_e,a(i,{id:"name",modelValue:s.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.name=o),name:"姓名",type:"text",class:_(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入 姓名",rules:"required"},null,8,["modelValue","class"]),a(r,{name:"姓名",class:"invalid-feedback"})]),e("div",pe,[ve,a(i,{id:"email",modelValue:s.value.email,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.email=o),name:"email",type:"email",class:_(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),a(r,{name:"email",class:"invalid-feedback"})]),e("div",fe,[he,a(i,{id:"tel",modelValue:s.value.tel,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.tel=o),name:"電話",type:"tel",class:_(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入 電話",rules:"required|min:8|max:10"},null,8,["modelValue","class"]),a(r,{name:"電話",class:"invalid-feedback"})]),e("div",be,[Ve,a(i,{id:"address",modelValue:s.value.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.address=o),name:"地址",type:"text",class:_(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入 地址",rules:"required"},null,8,["modelValue","class"]),a(r,{modelValue:s.value.address,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.address=o),name:"地址",class:"invalid-feedback"},null,8,["modelValue"])]),e("div",ge,[xe,M(e("textarea",{id:"message","onUpdate:modelValue":t[5]||(t[5]=o=>s.value.message=o),class:"form-control",placeholder:"請輸入 留言","aria-describedby":"message"},null,512),[[O,s.value.message]])]),ye]),_:1})])])])],64)}}};export{qe as default};
